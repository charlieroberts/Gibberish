/*! Gibberish v2.0.1 built on 24-09-2013 */
function AudioFileRequest(a,b){this.url=a,("undefined"==typeof b||null==b)&&(b=!0),this.async=b;var c=a.split(".");this.extension=c[c.length-1].toLowerCase()}function Decoder(){}function WAVDecoder(){}function AIFFDecoder(){}function createInput(){navigator.webkitGetUserMedia({audio:!0},function(a){Gibberish.mediaStreamSource=Gibberish.context.createMediaStreamSource(a),Gibberish.mediaStreamSource.connect(Gibberish.node),_hasInput=!0})}window.Gibberish={memo:{},codeblock:[],analysisCodeblock:[],analysisUgens:[],dirtied:[],id:0,isDirty:!1,out:null,debug:!1,callback:"",audioFiles:{},sequencers:[],callbackArgs:["input"],callbackObjects:[],analysisCallbackArgs:[],analysisCallbackObjects:[],createCallback:function(){this.memo={},this.codeblock.length=0,this.callbackArgs.length=0,this.callbackObjects.length=0,this.analysisCallbackArgs.length=0,this.dirtied.length=0,this.codestring="Gibberish.callback = function(input,",this.memo={},this.out.codegen();var codeblockStore=this.codeblock.slice(0);if(this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var i=0;i<this.analysisUgens.length;i++)this.analysisCallbackArgs.push(this.analysisUgens[i].analysisSymbol)}for(var i=0;i<this.callbackArgs.length;i++)this.codestring+=this.callbackArgs[i],i<this.callbackArgs.length-1&&(this.codestring+=", ");for(var i=0;i<this.analysisCallbackArgs.length;i++)this.codestring+=", ",this.codestring+=this.analysisCallbackArgs[i];if(this.codestring+="){\n	",this.memo={},this.codestring+=codeblockStore.join("	"),this.codestring+="\n	",this.analysisUgens.length>0){this.analysisCodeblock.length=0;for(var i=0;i<this.analysisUgens.length;i++)this.codeblock.length=0,this.analysisUgens[i].analysisCodegen();this.codestring+=this.analysisCodeblock.join("\n	"),this.codestring+="\n	"}return this.codestring+="return "+this.out.variable+";\n",this.codestring+="}",this.callbackString=this.codestring,this.debug,eval(this.codestring)},audioProcess:function(a){var b=a.outputBuffer.getChannelData(0),c=a.outputBuffer.getChannelData(1),d=a.inputBuffer.getChannelData(0),e=Gibberish,f=e.callback,g=e.sequencers,h=(Gibberish.out.callback,e.callbackObjects.slice(0));h.unshift(0);for(var i=0,j=a.outputBuffer.length;j>i;i++){for(var k=0;k<g.length;k++)g[k].tick();e.isDirty&&(f=e.createCallback(),e.isDirty=!1,h=e.callbackObjects.slice(0),h.unshift(0)),h[0]=d[i],val=f.apply(null,h),b[i]=val[0],c[i]=val[1]}},audioProcessFirefox:function(a){var b=Gibberish,c=b.callback,d=b.sequencers,e=b.callbackObjects.slice(0);e.unshift(0);for(var f=0,g=a.length;g>f;f+=2){for(var h=0;h<d.length;h++)d[h].tick();b.isDirty&&(c=b.createCallback(),b.isDirty=!1,e=b.callbackObjects.slice(0),e.unshift(0));var i=c.apply(null,e);a[f]=i[0],a[f+1]=i[1]}},clear:function(){this.out.inputs.length=0,this.analysisUgens.length=0,this.sequencers.length=0,this.callbackArgs.length=2,this.callbackObjects.length=1,Gibberish.dirty(this.out)},dirty:function(a){if("undefined"!=typeof a){for(var b=!1,c=0;c<this.dirtied.length;c++)this.dirtied[c].variable===a.variable&&(b=!0);b||(this.isDirty=!0,this.dirtied.push(a))}else this.isDirty=!0},generateSymbol:function(a){return a+"_"+this.id++},AudioDataDestination:function(a,b){var c=new Audio;c.mozSetup(2,a);var d,e=0,f=a/2,g=null;setInterval(function(){var a;if(g){if(a=c.mozWriteAudio(g.subarray(d)),e+=a,d+=a,d<g.length)return;g=null}var h=c.mozCurrentSampleOffset(),i=h+f-e;if(i>0){var j=new Float32Array(i);b(j),a=c.mozWriteAudio(j),h=c.mozCurrentSampleOffset(),a<j.length&&(g=j,d=a),e+=a}},100)},init:function(a,b,c){Gibberish.out=new Gibberish.Bus2,Gibberish.out.codegen(),Gibberish.dirty(Gibberish.out);var d="undefined"==typeof c?1024:c;return start=function(a,b){if(a)Gibberish.context=a;else{var c=document.getElementsByTagName("body");c&&c[0]&&c[0].removeEventListener("touchstart",start),Gibberish.context=new webkitAudioContext}if(Gibberish.node=Gibberish.context.createJavaScriptNode(d,2,2,Gibberish.context.sampleRate),Gibberish.node.onaudioprocess=Gibberish.audioProcess,b?Gibberish.node.connect(b):Gibberish.node.connect(Gibberish.context.destination),!a&&"ontouchstart"in document.documentElement){var e=Gibberish.context.createBufferSource();e.connect(Gibberish.context.destination),e.noteOn(0)}},!a&&"ontouchstart"in document.documentElement?document.getElementsByTagName("body")[0].addEventListener("touchstart",start):start(a,b),this},makePanner:function(){var a=Math.sin,b=Math.cos,c=Math.sqrt(2)/2,d=function(d,e,f){var g="object"==typeof d,h=g?d[0]:d,i=g?d[1]:d;return f[0]=h*c*(b(e)-a(e)),f[1]=i*c*(b(e)+a(e)),f};return d},defineUgenProperty:function(a,b,c){var d=c.properties[a]={value:b,binops:[],parent:c,name:a};Object.defineProperty(c,a,{configurable:!0,get:function(){return d.value},set:function(a){d.value=a,Gibberish.dirty(c)}})},polyInit:function(a){a.mod=a.polyMod,a.removeMod=a.removePolyMod;for(var b in a.polyProperties)!function(b){var c=a.polyProperties[b];Object.defineProperty(a,b,{configurable:!0,get:function(){return c},set:function(d){c=d;for(var e=0;e<a.children.length;e++)a.children[e][b]=c}})}(b)},interpolate:function(a,b){var c=0|b,d=c+1>a.length-1?0:c+1;return frac=b-c,a[c]+frac*(a[d]-a[c])},pushUnique:function(a,b){for(var c=a,d=!0,e=0;e<b.length;e++)if(c===b[e]){d=!1;break}d&&b.push(c)},"export":function(a,b){for(var c in Gibberish[a])b[c]=Gibberish[a][c]},ugen:function(){Gibberish.extend(this,{processProperties:function(){if("object"!=typeof arguments[0][0]||"undefined"!=typeof arguments[0][0].type||Array.isArray(arguments[0][0])||"op"===arguments[0][0].name){var a=0;for(var b in this.properties)"object"==typeof this.properties[b]&&"undefined"!=typeof this.properties[b].binops?"undefined"!=typeof arguments[0][a]&&(this.properties[b].value=arguments[0][a++]):"undefined"!=typeof arguments[0][a]&&(this.properties[b]=arguments[0][a++])}else{var c=arguments[0][0];for(var b in c)"undefined"!=typeof c[b]&&("object"==typeof this.properties[b]&&"undefined"!=typeof this.properties[b].binops?this.properties[b].value=c[b]:this[b]=c[b])}return this},codegen:function(){var a="",b=null;if(Gibberish.memo[this.symbol])return Gibberish.memo[this.symbol];b=this.variable?this.variable:Gibberish.generateSymbol("v"),Gibberish.memo[this.symbol]=b,this.variable=b,a+="var "+b+" = "+this.symbol+"(";for(var c in this.properties){var d=this.properties[c],e="";if(Array.isArray(d.value)){0===d.value.length&&(e=0);for(var f=0;f<d.value.length;f++){var g=d.value[f];e+="object"==typeof g?null!==g?g.codegen():"null":"function"==typeof d.value?d.value():d.value,e+=f<d.value.length-1?", ":""}}else"object"==typeof d.value?e=null!==d.value?d.value.codegen():"null":"undefined"!==d.name&&(e="function"==typeof d.value?d.value():d.value);if(0!=d.binops.length){for(var h=0;h<d.binops.length;h++)a+="(";for(var i=0;i<d.binops.length;i++){var j,k=d.binops[i];j="number"==typeof k.ugen?k.ugen:null!==k.ugen?k.ugen.codegen():"null","="===k.binop?(a=a.replace(e,""),a+=j):"++"===k.binop?a+=" + Math.abs("+j+")":(0===i&&(a+=e),a+=" "+k.binop+" "+j+")")}}else a+=e;a+=", "}return" "===a.charAt(a.length-1)&&(a=a.slice(0,-2)),a+=");\n",this.codeblock=a,-1===Gibberish.codeblock.indexOf(this.codeblock)&&Gibberish.codeblock.push(this.codeblock),-1===Gibberish.callbackArgs.indexOf(this.symbol)&&"op"!==this.name&&Gibberish.callbackArgs.push(this.symbol),-1===Gibberish.callbackObjects.indexOf(this.callback)&&"op"!==this.name&&Gibberish.callbackObjects.push(this.callback),this.dirty=!1,b},init:function(){if(this.initalized||(this.symbol=Gibberish.generateSymbol(this.name),this.codeblock=null,this.variable=null),"undefined"==typeof this.properties&&(this.properties={}),!this.initialized){this.destinations=[];for(var a in this.properties)Gibberish.defineUgenProperty(a,this.properties[a],this)}if(arguments.length>0&&"object"==typeof arguments[0][0]&&"undefined"===arguments[0][0].type){var b=arguments[0][0];for(var a in b)this[a]=b[a]}return this.initialized=!0,this},mod:function(a,b,c){var d=this.properties[a],e={ugen:b,binop:c};d.binops.push(e),Gibberish.dirty(this)},removeMod:function(a,b){if("undefined"==typeof b)this.properties[a].binops.length=0;else if("number"==typeof b)this.properties[a].binops.splice(b,1);else if("object"==typeof b)for(var c=0,d=this.properties[a].binops.length;d>c;c++)this.properties[a].binops[c].ugen===b&&this.properties[a].binops.splice(c,1);Gibberish.dirty(this)},polyMod:function(a,b,c){for(var d=0;d<this.children.length;d++)this.children[d].mod(a,b,c);Gibberish.dirty(this)},removePolyMod:function(){var a=Array.prototype.slice.call(arguments,0);if("amp"!==arguments[0]&&"pan"!==arguments[0])for(var b=0;b<this.children.length;b++)this.children[b].removeMod.apply(this.children[b],a);else this.removeMod.apply(this,a);Gibberish.dirty(this)},smooth:function(a){var b=new Gibberish.OnePole;this.mod(a,b,"=")},connect:function(a){return"undefined"==typeof a&&(a=Gibberish.out),-1===this.destinations.indexOf(a)&&(a.addConnection(this,1),this.destinations.push(a)),this},send:function(a,b){return-1===this.destinations.indexOf(a)?(a.addConnection(this,b),this.destinations.push(a)):a.adjustSendAmount(this,b),this},disconnect:function(a,b){var c;if(a)c=this.destinations.indexOf(a),c>-1&&this.destinations.splice(c,1),a.removeConnection(this);else{for(var d=0;d<this.destinations.length;d++)this.destinations[d].removeConnection(this);this.destinations=[]}return Gibberish.dirty(this),this}})}},Array2=function(){this.length=0},Array2.prototype=[],Array2.prototype.remove=function(a,b){if(b="undefined"==typeof b?!0:b,"undefined"==typeof a){for(var c=0;c<this.length;c++)delete this[c];this.length=0}else if("number"==typeof a)this.splice(a,1);else if("string"==typeof a){for(var d=[],c=0;c<this.length;c++){var e=this[c];if(e.type===a||e.name===a){if(!b)return this.splice(c,1),void 0;d.push(c)}}for(var c=0;c<d.length;c++)this.splice(d[c],1)}else if("object"==typeof a)for(var f=this.indexOf(a);f>-1;)this.splice(f,1),f=this.indexOf(a);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.get=function(a){if("number"==typeof a)return this[a];if("string"==typeof a)for(var b=0;b<this.length;b++){var c=this[b];if(c.name===a)return c}else if("object"==typeof a){var d=this.indexOf(a);if(d>-1)return this[d]}return null},Array2.prototype.replace=function(a,b){if(b.parent=this,b.input=a.input,"number"!=typeof a){var c=this.indexOf(a);c>-1&&this.splice(c,1,b)}else this.splice(a,1,b);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.insert=function(a,b){if(a.parent=this,this.input=this.parent,Array.isArray(a))for(var c=0;c<a.length;c++)this.splice(b+c,0,a[c]);else this.splice(b,0,a);this.parent&&Gibberish.dirty(this.parent)},Array2.prototype.add=function(){for(var a=0;a<arguments.length;a++)arguments[a].parent=this,arguments[a].input=this.parent,this.push(arguments[a]);this.parent&&Gibberish.dirty(this.parent)};var rnd=Math.random;Gibberish.rndf=function(a,b,c,d){if(d="undefined"==typeof d?!0:d,"undefined"==typeof c&&"object"!=typeof a){1==arguments.length?(a=0,b=arguments[0]):2==arguments.length?(a=arguments[0],b=arguments[1]):(a=0,b=1);var e=b-a,f=rnd(),g=e*f;return a+g}var h=[],i=[];"undefined"==typeof c&&(c=b||a.length);for(var j=0;c>j;j++){var k;if("object"==typeof arguments[0])k=arguments[0][randomi(0,arguments[0].length-1)];else if(d)k=Gibberish.rndf(a,b);else{for(k=Gibberish.rndf(a,b);i.indexOf(k)>-1;)k=Gibberish.rndf(a,b);i.push(k)}h.push(k)}return h},Gibberish.Rndf=function(){var a,b,c=Math.random;return 0===arguments.length?(a=0,b=1):1===arguments.length?(a=0,b=arguments[0]):(a=arguments[0],b=arguments[1]),function(){var d=a+c()*b;return d}},Gibberish.rndi=function(){var a,b;return 0===arguments.length?(a=0,b=1):1===arguments.length?(a=0,b=arguments[0]):(a=arguments[0],b=arguments[1]),Math.round(a+Math.random()*b)},Gibberish.Rndi=function(){var a,b,c=Math.random,d=Math.round;return 0===arguments.length?(a=0,b=1):1===arguments.length?(a=0,b=arguments[0]):(a=arguments[0],b=arguments[1]),function(){var e=d(a+c()*b);return e}},Gibberish.extend=function(a,b){for(var c in b)c.split("."),b[c]instanceof Array&&b[c].length<100?(a[c]=b[c].slice(0),"fx"===c&&(a[c].parent=b[c].parent)):"object"!=typeof b[c]||null===b[c]||b[c]instanceof Float32Array?a[c]=b[c]:(a[c]=a[c]||{},arguments.callee(a[c],b[c]));return a},Function.prototype.clone=function(){return eval("["+this.toString()+"]")[0]},String.prototype.format=function(a,b,c){function d(){var d=this,e=arguments.length+1;for(a=0;e>a;c=arguments[a++])b=c,d=d.replace(RegExp("\\{"+(a-1)+"\\}","g"),b);return d}return d.native=String.prototype.format,d}(),Gibberish.future=function(a,b){var c=new Gibberish.Sequencer({values:[function(){},function(){a(),c.stop(),c.disconnect()}],durations:[b]}).start()},Gibberish.Proxy=function(){var a=0;Gibberish.extend(this,{name:"proxy",type:"effect",properties:{},callback:function(){return a}}).init(),this.input=arguments[0],a=this.input.parent[this.input.name],delete this.input.parent[this.input.name],this.input.parent.properties[this.input.name].value=this,Object.defineProperty(this.input.parent,this.input.name,{get:function(){return a},set:function(b){a=b}}),Gibberish.dirty(this.input.parent)},Gibberish.Proxy.prototype=new Gibberish.ugen,Gibberish.Proxy2=function(){var a=arguments[0],b=arguments[1];Gibberish.extend(this,{name:"proxy2",type:"effect",properties:{},callback:function(){var c=a[b];return Array.isArray(c)?(c[0]+c[1]+c[2])/3:c}}).init(),this.getInput=function(){return a},this.getName=function(){return b}},Gibberish.Proxy2.prototype=new Gibberish.ugen,Gibberish.Proxy3=function(){var a=arguments[0],b=arguments[1];Gibberish.extend(this,{name:"proxy3",type:"effect",properties:{},callback:function(){var c=a[b];return c||0}}),this.init(),this.codegen=function(){this.variable||(this.variable=Gibberish.generateSymbol("v")),Gibberish.callbackArgs.push(this.symbol),Gibberish.callbackObjects.push(this.callback),this.codeblock="var "+this.variable+" = "+this.symbol+"("+a.properties[b].codegen()+");\n"}},Gibberish.Proxy3.prototype=new Gibberish.ugen,Gibberish.oscillator=function(){this.type="oscillator",this.oscillatorInit=function(){return this.fx=new Array2,this.fx.parent=this,this}},Gibberish.oscillator.prototype=new Gibberish.ugen,Gibberish._oscillator=new Gibberish.oscillator,Gibberish.Wavetable=function(){var a=0,b=null,c=Gibberish.context.sampleRate/1024;this.properties={frequency:440,amp:.25},this.getTable=function(){return b},this.setTable=function(a){b=a},this.callback=function(d,e){var f,g,h,i,j;for(a+=d/c;a>=1024;)a-=1024;return f=0|a,g=a-f,f=1023&f,h=1023===f?0:f+1,i=b[f],j=b[h],(i+g*(j-i))*e}},Gibberish.Wavetable.prototype=Gibberish._oscillator,Gibberish.asmSine=function(a,b,c){"use asm";function d(){for(var a=1024,b=1024;a=a-1|0;)b-=1,i[a>>2]=+g(+(b/1024)*6.2848);k=44100/1024}function e(a,b,c){a=+a,b=+b,c=+c;var d=0,e=0,f=0,g=0,l=0,m=0;return h=+(h+a/k),h>=1024&&(h=+(h-1024)),d=+j(h),g=h-d,e=~~d,f=(e|0)==1024?0:e+1|0,l=+i[e>>2],m=+i[f>>2],+((l+g*(m-l))*b)}function f(a){return a|=0,+i[a>>2]}var g=a.Math.sin,h=0,i=new a.Float32Array(c),j=a.Math.floor,k=0;return{init:d,gen:e,get:f}},Gibberish.asmSine2=function(){this.properties={frequency:440,amp:.5,sr:Gibberish.context.sampleRate},this.name="sine";var a=new ArrayBuffer(4096),b=Gibberish.asmSine(window,null,a);return b.init(),this.getTable=function(){return a},this.get=b.get,this.callback=b.gen,this.init(),this.oscillatorInit(),this.processProperties(arguments),this},Gibberish.asmSine2.prototype=Gibberish._oscillator,Gibberish.Sine=function(){this.__proto__=new Gibberish.Wavetable,this.name="sine";for(var a=2*Math.PI,b=new Float32Array(1024),c=1024;c--;)b[c]=Math.sin(c/1024*a);this.setTable(b),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Sine2=function(){this.__proto__=new Gibberish.Sine,this.name="sine2",this.defineUgenProperty("pan",0);var a=this.__proto__.callback,b=Gibberish.makePanner(),c=[0,0];this.callback=function(d,e,f){var g=a(d,e);return c=b(g,f,c)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Square=function(){this.__proto__=new Gibberish.Wavetable,this.name="square";for(var a=(2*Math.PI,new Float32Array(1024)),b=1024;b--;)a[b]=b/1024>.5?1:-1;this.setTable(a),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw=function(){this.__proto__=new Gibberish.Wavetable,this.name="saw";for(var a=new Float32Array(1024),b=1024;b--;)a[b]=4*((b/1024/2+.25)%.5-.25);this.setTable(a),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw2=function(){this.__proto__=new Gibberish.Saw,this.name="saw2",this.defineUgenProperty("pan",0);var a=this.__proto__.callback,b=Gibberish.makePanner(),c=[0,0];this.callback=function(d,e,f){var g=a(d,e);return c=b(g,f,c)},this.init()},Gibberish.Triangle=function(){this.__proto__=new Gibberish.Wavetable,this.name="triangle";for(var a=new Float32Array(1024),b=Math.abs,c=1024;c--;)a[c]=1-4*b((c/1024+.25)%1-.5);this.setTable(a),this.init(arguments),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Triangle2=function(){this.__proto__=new Gibberish.Triangle,this.name="triangle2",this.defineUgenProperty("pan",0);var a=this.__proto__.callback,b=Gibberish.makePanner(),c=[0,0];this.callback=function(d,e,f){var g=a(d,e);return b(g,f,c)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw3=function(){var a=0,b=0,c=2.5,d=-1.5,e=0,f=Math.sin,g=11;pi_2=2*Math.PI,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"saw",properties:{frequency:440,amp:.15,sr:Gibberish.context.sampleRate},callback:function(h){var i=h/sr,j=.5-i,k=g*j*j*j*j,l=.376-.752*i,m=1-2*i,n=0;return b+=i,b-=b>1?2:0,a=.5*(a+f(pi_2*(b+a*k))),n=c*a+d*e,e=a,n+=l,n*m}}),Object.defineProperty(this,"scale",{get:function(){return g},set:function(a){g=a}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Saw3.prototype=Gibberish._oscillator,Gibberish.PWM=function(){var a=0,b=0,c=0,d=0,e=0,f=2.5,g=-1.5,h=Math.sin,i=11;pi_2=2*Math.PI,test=0,sr=Gibberish.context.sampleRate,Gibberish.extend(this,{name:"pwm",properties:{frequency:440,amp:.15,pulsewidth:.05,sr:Gibberish.context.sampleRate},callback:function(j,k,l){var m=j/sr,n=.5-m,o=i*n*n*n*n,p=1-2*m,q=0;return e+=m,e-=e>1?2:0,a=.5*(a+h(pi_2*(e+a*o))),b=.5*(b+h(pi_2*(e+b*o+l))),q=b-a,q=f*q+g*(c-d),c=a,d=b,q*p*k}}),Object.defineProperty(this,"scale",{get:function(){return i},set:function(a){i=a}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.PWM.prototype=Gibberish._oscillator,Gibberish.Noise=function(){var a=Math.random;Gibberish.extend(this,{name:"noise",properties:{amp:1},callback:function(b){return(2*a()-1)*b}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Noise.prototype=Gibberish._oscillator,Gibberish.KarplusStrong=function(){var a=[0],b=0,c=Math.random,d=Gibberish.makePanner(),e=Gibberish.context.sampleRate,f=[0,0];Gibberish.extend(this,{name:"karplus_strong",frequency:0,properties:{blend:1,damping:0,amp:1,channels:2,pan:0},note:function(b){var d=Math.floor(e/b);a.length=0;for(var f=0;d>f;f++)a[f]=2*c()-1;this.frequency=b},callback:function(e,g,h,i,j){var k=a.shift(),l=c()>e?-1:1;g=g>0?g:0;var m=l*(k+b)*(.5-g/100);return b=m,a.push(m),m*=h,1===i?m:d(m,j,f)}}).init().oscillatorInit().processProperties(arguments)},Gibberish.KarplusStrong.prototype=Gibberish._oscillator,Gibberish.PolyKarplusStrong=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"poly_karplus_strong",maxVoices:5,voiceCount:0,polyProperties:{blend:1,damping:0},note:function(a,b){var c=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),c.note(a,b),this.frequency=a}}),this.amp=1/this.maxVoices,Gibberish.polyInit(this),this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices);for(var a=0;a<this.maxVoices;a++){var b={blend:this.blend,damping:this.damping,channels:2,amp:1},c=new Gibberish.KarplusStrong(b).connect(this);this.children.push(c)}this.processProperties(arguments),this.initialized=!1,Gibberish._synth.oscillatorInit.call(this),Gibberish.dirty(this)},Gibberish.bus=function(){this.type="bus",this.inputCodegen=function(){var a=this.value.codegen(),b=1===this.amp?a:a+" * "+this.amp;return this.codeblock=b,b},this.addConnection=function(){var a={value:arguments[0],amp:arguments[1],codegen:this.inputCodegen};this.inputs.push(a),Gibberish.dirty(this)},this.removeConnection=function(a){for(var b=0;b<this.inputs.length;b++)if(this.inputs[b].value===a){this.inputs.splice(b,1),Gibberish.dirty(this);break}},this.adjustSendAmount=function(a,b){for(var c=0;c<this.inputs.length;c++)if(this.inputs[c].value===a){this.inputs[c].amp=b,Gibberish.dirty(this);break}},this.callback=function(){var a=arguments[arguments.length-2],b=arguments[arguments.length-1];output[0]=output[1]=0;for(var c=0;c<arguments.length-2;c++){var d="object"==typeof arguments[c];output[0]+=d?arguments[c][0]:arguments[c],output[1]+=d?arguments[c][1]:arguments[c]}return output[0]*=a,output[1]*=a,panner(output,b,output)}},Gibberish.bus.prototype=new Gibberish.ugen,Gibberish._bus=new Gibberish.bus,Gibberish.Bus=function(){return Gibberish.extend(this,{name:"bus",properties:{inputs:[],amp:1},callback:function(){for(var a=0,b=arguments.length-1,c=arguments[b],d=0;b>d;d++)a+=arguments[d];return a*=c}}),this.init(),this.processProperties(arguments),this},Gibberish.Bus.prototype=Gibberish._bus,Gibberish.Bus2=function(){this.name="bus2",this.type="bus",this.properties={inputs:[],amp:1,pan:0};var a=[0,0],b=Gibberish.makePanner();this.callback=function(){var c=arguments,d=c.length,e=c[d-2],f=c[d-1];a[0]=a[1]=0;for(var g=0,h=d-2;h>g;g++){var i="object"==typeof c[g];a[0]+=i?c[g][0]||0:c[g]||0,a[1]+=i?c[g][1]||0:c[g]||0}return a[0]*=e,a[1]*=e,b(a,f,a)},this.show=function(){},this.getOutput=function(){return a},this.getArgs=function(){return args},this.init(arguments),this.processProperties(arguments)},Gibberish.Bus2.prototype=Gibberish._bus,Gibberish.envelope=function(){this.type="envelope"},Gibberish.envelope.prototype=new Gibberish.ugen,Gibberish._envelope=new Gibberish.envelope,Gibberish.ExponentialDecay=function(){var a=Math.pow,b=0,c=0;Gibberish.extend(this,{name:"ExponentialDecay",properties:{decay:.5,length:11050},callback:function(d,e){return b=a(d,c),c+=1/e,b},trigger:function(){c="number"==typeof arguments[0]?arguments[0]:0}}).init()},Gibberish.ExponentialDecay.prototype=Gibberish._envelope,Gibberish.Line=function(a,b,c,d){var e={name:"line",properties:{start:a||0,end:isNaN(b)?1:b,time:c||Gibberish.context.sampleRate,loops:d||!1}},f=0,g=(b-a)/c;return this.callback=function(a,b,c,d){var e=c>f?a+f++*g:b;return f=e>=b&&d?0:f,e},Gibberish.extend(this,e),this.init(),this},Gibberish.Line.prototype=Gibberish._envelope,Gibberish.AD=function(a,b){var c=0,d=0;Gibberish.extend(this,{name:"AD",properties:{attack:a||1e4,decay:b||1e4},run:function(){return d=0,c=0,this},callback:function(a,b){if(a=0>a?22050:a,b=0>b?22050:b,0===d){var e=1/a;c+=e,c>=1&&d++}else if(1===d){var e=1/b;c-=e,0>=c&&(c=0,d++)}return c},getState:function(){return d}}).init().processProperties(arguments)},Gibberish.AD.prototype=Gibberish._envelope,Gibberish.ADSR=function(a,b,c,d,e,f){var g={name:"adsr",type:"envelope",properties:{attack:isNaN(a)?1e4:a,decay:isNaN(b)?1e4:b,sustain:isNaN(c)?22050:c,release:isNaN(d)?1e4:d,attackLevel:e||1,sustainLevel:f||.5},run:function(){this.setPhase(0),this.setState(0)}};Gibberish.extend(this,g);var h=0,i=0;return this.callback=function(a,b,c,d,e,f){var g=0;return 0===i?(g=h/a*e,1===++h/a&&(i++,h=b)):1===i?(g=h/b*(e-f)+f,--h<=0&&(null!==c?(i+=1,h=c):(i+=2,h=d))):2===i?(g=f,0===h--&&(i++,h=d)):3===i&&(h--,g=h/d*f,0>=h&&i++),g},this.setPhase=function(a){h=a},this.setState=function(a){i=a,h=0},this.getState=function(){return i},this.init(),this},Gibberish.ADSR.prototype=Gibberish._envelope,Gibberish.ADR=function(a,b,c,d,e){var f={name:"adr",type:"envelope",properties:{attack:isNaN(a)?11025:a,decay:isNaN(b)?11025:b,release:isNaN(c)?22050:c,attackLevel:d||1,releaseLevel:e||.2},run:function(){this.setPhase(0),this.setState(0)}};Gibberish.extend(this,f);var g=0,h=0;return this.callback=function(a,b,c,d,e){var f=0;return 0===h?(f=g/a*d,1===++g/a&&(h++,g=b)):1===h?(f=g/b*(d-e)+e,--g<=0&&(h+=1,g=c)):2===h&&(g--,f=g/c*e,0>=g&&h++),f},this.setPhase=function(a){g=a},this.setState=function(a){h=a,g=0},this.getState=function(){return h},this.init(),this},Gibberish.ADR.prototype=Gibberish._envelope,Gibberish.analysis=function(){this.type="analysis",this.codegen=function(){return Gibberish.memo[this.symbol]?Gibberish.memo[this.symbol]:(v=this.variable?this.variable:Gibberish.generateSymbol("v"),Gibberish.memo[this.symbol]=v,this.variable=v,Gibberish.callbackArgs.push(this.symbol),Gibberish.callbackObjects.push(this.callback),this.codeblock="var "+this.variable+" = "+this.symbol+"();\n",-1===Gibberish.codeblock.indexOf(this.codeblock)&&Gibberish.codeblock.push(this.codeblock),this.variable)},this.analysisCodegen=function(){var a=0;this.input.codegen?(a=this.input.codegen(),a.indexOf("op")>-1):a=this.input.value?"undefined"!=typeof this.input.value.codegen?this.input.value.codegen():this.input.value:"null";var b=this.analysisSymbol+"("+a+",";for(var c in this.properties)"input"!==c&&(b+=this[c]+",");return b=b.slice(0,-1),b+=");",this.analysisCodeblock=b,-1===Gibberish.analysisCodeblock.indexOf(this.analysisCodeblock)&&Gibberish.analysisCodeblock.push(this.analysisCodeblock),-1===Gibberish.callbackObjects.indexOf(this.analysisCallback)&&Gibberish.callbackObjects.push(this.analysisCallback),b},this.remove=function(){Gibberish.analysisUgens.splice(Gibberish.analysisUgens.indexOf(this),1)},this.analysisInit=function(){this.analysisSymbol=Gibberish.generateSymbol(this.name),Gibberish.analysisUgens.push(this),Gibberish.dirty(),this.analysisCodegen()}},Gibberish.analysis.prototype=new Gibberish.ugen,Gibberish._analysis=new Gibberish.analysis,Gibberish.Follow=function(){this.name="follow",this.properties={input:0,bufferSize:4410,mult:1};var a=Math.abs,b=[0],c=0,d=0,e=0;this.analysisCallback=function(f,g,h){"object"==typeof f&&(f=f[0]+f[1]),c+=a(f),c-=b[d],b[d]=a(f),d=(d+1)%g,b[d]=b[d]?b[d]:0,e=c/g*h},this.callback=this.getValue=function(){return e},this.init(),this.analysisInit(),this.processProperties(arguments)},Gibberish.Follow.prototype=Gibberish._analysis,Gibberish.SingleSampleDelay=function(){this.name="single_sample_delay",this.properties={input:arguments[0]||0,amp:arguments[1]||1};var a=0;this.analysisCallback=function(b){a=b},this.callback=function(){return a},this.getValue=function(){return a},this.init(),this.analysisInit(),this.processProperties(arguments)},Gibberish.SingleSampleDelay.prototype=Gibberish._analysis,Gibberish.Record=function(a,b,c){var d=new Float32Array(b),e=0,f=!1,g=this;Gibberish.extend(this,{name:"record",oncomplete:c,properties:{input:0,size:b||0},analysisCallback:function(a,b){f&&(d[e++]="object"==typeof a?a[0]+a[1]:a,e>=b&&(f=!1,g.remove()))},record:function(){return e=0,f=!0,this},getBuffer:function(){return d},getPhase:function(){return e},remove:function(){"undefined"!=typeof this.oncomplete&&this.oncomplete();for(var a=0;a<Gibberish.analysisUgens.length;a++){var b=Gibberish.analysisUgens[a];if(b===this)return Gibberish.callbackArgs.indexOf(this.analysisSymbol)>-1&&Gibberish.callbackArgs.splice(Gibberish.callbackArgs.indexOf(this.analysisSymbol),1),Gibberish.callbackObjects.indexOf(this.analysisCallback)>-1&&Gibberish.callbackObjects.splice(Gibberish.callbackObjects.indexOf(this.analysisCallback),1),Gibberish.analysisUgens.splice(a,1),void 0}}}),this.properties.input=a,this.init(),this.analysisInit(),Gibberish.dirty()},Gibberish.Record.prototype=Gibberish._analysis,Gibberish.effect=function(){this.type="effect"},Gibberish.effect.prototype=new Gibberish.ugen,Gibberish._effect=new Gibberish.effect,Gibberish.Distortion=function(){var a=Math.abs,b=Math.log,c=Math.LN2;Gibberish.extend(this,{name:"distortion",properties:{input:0,amount:50},callback:function(d,e){var f;return e=e>2?e:2,"number"==typeof d?(f=d*e,d=f/(1+a(f))/(b(e)/c)):(f=d[0]*e,d[0]=f/(1+a(f))/(b(e)/c),f=d[1]*e,d[1]=f/(1+a(f))/(b(e)/c)),d}}).init().processProperties(arguments)},Gibberish.Distortion.prototype=Gibberish._effect,Gibberish.Delay=function(){var a=[],b=0;a.push(new Float32Array(2*Gibberish.context.sampleRate)),a.push(new Float32Array(2*Gibberish.context.sampleRate)),Gibberish.extend(this,{name:"delay",properties:{input:0,time:22050,feedback:.5},callback:function(c,d,e){var f="number"==typeof c?1:2,g=b++%88200,h=(g+(0|d))%88200;return 1===f?(a[0][h]=(c+a[0][g])*e,c+=a[0][g]):(a[0][h]=(c[0]+a[0][g])*e,c[0]+=a[0][g],a[1][h]=(c[1]+a[1][g])*e,c[1]+=a[1][g]),c}});var c=Math.round(this.properties.time);Object.defineProperty(this,"time",{configurable:!0,get:function(){return c},set:function(a){c=Math.round(a),Gibberish.dirty(this)}}),this.init(),this.processProperties(arguments)},Gibberish.Delay.prototype=Gibberish._effect,Gibberish.Decimator=function(){var a=0,b=[],c=Math.pow,d=Math.floor;Gibberish.extend(this,{name:"decimator",properties:{input:0,bitDepth:16,sampleRate:1},callback:function(e,f,g){a+=g;var h="number"==typeof e?1:2;if(1===h){if(a>=1){var i=c(f,2);b[0]=d(e*i)/i,a-=1}e=b[0]}else{if(a>=1){var i=c(f,2);b[0]=d(e[0]*i)/i,b[1]=d(e[1]*i)/i,a-=1}e=b}return e}}).init().processProperties(arguments)},Gibberish.Decimator.prototype=Gibberish._effect,Gibberish.RingModulation=function(){var a=(new Gibberish.Sine).callback,b=[0,0];Gibberish.extend(this,{name:"ringmod",properties:{input:0,frequency:440,amp:.5,mix:.5},callback:function(c,d,e,f){var g="number"==typeof c?1:2,h=1===g?c:c[0],i=a(d,e);if(h=h*(1-f)+h*i*f,2===g){var j=c[1];return j=j*(1-f)+j*i*f,b[0]=h,b[1]=j,b}return h}}).init().processProperties(arguments)},Gibberish.RingModulation.prototype=Gibberish._effect,Gibberish.OnePole=function(){var a=0;Gibberish.extend(this,{name:"onepole",type:"effect",properties:{input:0,a0:.15,b1:.85},callback:function(b,c,d){var e=b*c+a*d;return a=e,e},smooth:function(b,c){this.input=c[b],a=this.input,c[b]=this,this.obj=c,this.property=b,this.oldSetter=c.__lookupSetter__(b),this.oldGetter=c.__lookupGetter__(b);var d=this;Object.defineProperty(c,b,{get:function(){return d.input},set:function(a){d.input=a}})},remove:function(){Object.defineProperty(this.obj,this.property,{get:this.oldGetter,set:this.oldSetter}),this.obj[this.property]=this.input}}).init().processProperties(arguments)},Gibberish.OnePole.prototype=Gibberish._effect,Gibberish.Filter24=function(){var a=[0,0,0,0],b=[0,0,0,0],c=[0,0],d=isNaN(arguments[0])?.1:arguments[0],e=isNaN(arguments[1])?3:arguments[1];_isLowPass="undefined"!=typeof arguments[2]?arguments[2]:!0,Gibberish.extend(this,{name:"filter24",properties:{input:0,cutoff:d,resonance:e,isLowPass:_isLowPass},callback:function(d,e,f,g){var h="number"==typeof d?1:2,i=1===h?d:d[0],j=a[3]*f;if(j=j>1?1:j,e=0>e?0:e,e=e>1?1:e,i-=j,a[0]=a[0]+(-a[0]+i)*e,a[1]=a[1]+(-a[1]+a[0])*e,a[2]=a[2]+(-a[2]+a[1])*e,a[3]=a[3]+(-a[3]+a[2])*e,i=g?a[3]:i-a[3],2===h){var k=d[1];return j=b[3]*f,j=j>1?1:j,k-=j,b[0]=b[0]+(-b[0]+k)*e,b[1]=b[1]+(-b[1]+b[0])*e,b[2]=b[2]+(-b[2]+b[1])*e,b[3]=b[3]+(-b[3]+b[2])*e,k=g?b[3]:k-b[3],c[0]=i,c[1]=k,c}return i}}).init().processProperties(arguments)},Gibberish.Filter24.prototype=Gibberish._effect,Gibberish.SVF=function(){var a=[0,0],b=[0,0],c=Math.PI,d=[0,0];Gibberish.extend(this,{name:"SVF",properties:{input:0,cutoff:440,Q:2,mode:0,sr:Gibberish.context.sampleRate},callback:function(e,f,g,h,i){var j="number"==typeof e?1:2,k=1===j?e:e[0],l=2*c*f/i;g=1/g;var m=b[0]+l*a[0],n=k-m-g*a[0],o=l*n+a[0],p=n+m;if(a[0]=o,b[0]=m,k=0===h?m:1===h?n:2===h?o:p,2===j){var q=e[1],m=b[1]+l*a[1],n=q-m-g*a[1],o=l*n+a[1],p=n+m;a[1]=o,b[1]=m,q=0===h?m:1===h?n:2===h?o:p,d[0]=k,d[1]=q}else d=k;return d}}).init().processProperties(arguments)},Gibberish.SVF.prototype=Gibberish._effect,Gibberish.Biquad=function(){var a=x2=y1=y2=0,b=[0,0],c=.001639,d=.003278,e=.001639,f=-1.955777,g=.960601,h="LP",i=2e3,j=.5,k=Gibberish.context.sampleRate;
Gibberish.extend(this,{name:"biquad",properties:{input:null},calculateCoefficients:function(){switch(h){case"LP":var a=2*Math.PI*i/k,b=Math.sin(a),l=Math.cos(a),m=b/(2*j);c=(1-l)/2,d=1-l,e=c,a0=1+m,f=-2*l,g=1-m;break;case"HP":var a=2*Math.PI*i/k,b=Math.sin(a),l=Math.cos(a),m=b/(2*j);c=(1+l)/2,d=-(1+l),e=c,a0=1+m,f=-2*l,g=1-m;break;case"BP":var a=2*Math.PI*i/k,b=Math.sin(a),l=Math.cos(a),n=Math.log(2)/2*j*a/b,m=b*(Math.exp(n)-Math.exp(-n))/2;c=m,d=0,e=-m,a0=1+m,f=-2*l,g=1-m;break;default:return}c/=a0,d/=a0,e/=a0,f/=a0,g/=a0},callback:function(h){var i="number"==typeof h?1:2,j=0,k=0,l=1===i?h:h[0];return j=c*l+d*a+e*x2-f*y1-g*y2,x2=a,a=h,y2=y1,y1=j,2===i&&(inR=h[1],k=c*inR+d*a[1]+e*x2[1]-f*y1[1]-g*y2[1],x2[1]=a[1],a[1]=h[1],y2[1]=y1[1],y1[1]=k,b[0]=j,b[1]=k),1===i?j:b}}).init(),Object.defineProperties(this,{mode:{get:function(){return h},set:function(a){h=a,this.calculateCoefficients()}},cutoff:{get:function(){return i},set:function(a){i=a,this.calculateCoefficients()}},Q:{get:function(){return j},set:function(a){j=a,this.calculateCoefficients()}}}),this.processProperties(arguments),this.calculateCoefficients()},Gibberish.Biquad.prototype=Gibberish._effect,Gibberish.Flanger=function(){var a=[new Float32Array(88200),new Float32Array(88200)],b=88200,c=(new Gibberish.Sine).callback,d=Gibberish.interpolate,e=-100,f=0;Gibberish.extend(this,{name:"flanger",properties:{input:0,rate:.25,amount:125,feedback:0,offset:125},callback:function(g,h,i,j){var k="number"==typeof g?1:2,l=e+c(h,.95*i);l>b?l-=b:0>l&&(l+=b);var m=d(a[0],l);return a[0][f]=1===k?g+m*j:g[0]+m*j,2===k?(g[0]+=m,m=d(a[1],l),a[1][f]=g[1]+m*j,g[1]+=m):g+=m,++f>=b&&(f=0),++e>=b&&(e=0),g}}).init().processProperties(arguments),e=-1*this.offset},Gibberish.Flanger.prototype=Gibberish._effect,Gibberish.Vibrato=function(){var a=[new Float32Array(88200),new Float32Array(88200)],b=88200,c=(new Gibberish.Sine).callback,d=Gibberish.interpolate,e=-100,f=0;Gibberish.extend(this,{name:"vibrato",properties:{input:0,rate:5,amount:.5,offset:125},callback:function(g,h,i,j){var k="number"==typeof g?1:2,l=e+c(h,i*j-1);l>b?l-=b:0>l&&(l+=b);var m=d(a[0],l);return a[0][f]=1===k?g:g[0],2===k?(g[0]=m,m=d(a[1],l),a[1][f]=g[1],g[1]=m):g=m,++f>=b&&(f=0),++e>=b&&(e=0),g}}).init().processProperties(arguments),e=-1*this.offset},Gibberish.Vibrato.prototype=Gibberish._effect,Gibberish.BufferShuffler=function(){var a=[new Float32Array(88200),new Float32Array(88200)],b=88200,c=0,d=0,e=0,f=0,g=0,h=Math.random,i=1,j=!1,k=!1,l=!1,m=Gibberish.interpolate,n=!1,o=1,p=!1,q=Gibberish.rndf,r=[0,0];Gibberish.extend(this,{name:"buffer_shuffler",properties:{input:0,chance:.25,rate:11025,length:22050,reverseChange:.5,pitchChance:.5,pitchMin:.25,pitchMax:2,wet:1,dry:0},callback:function(s,t,u,v,w,x,y,z,A,B){var C="number"==typeof s?1:2;g?0===++f%(v-400)&&(j=!1,k=!0,i=1,f=0):(a[0][d]=1===C?s:s[0],a[1][d]=1===C?s:s[1],d++,d%=b,p=0===d?1:p,e++,0==e%u&&h()<t&&(l=h()<w,g=!0,l||(c=d-v,0>c&&(c=b+c)),n=h()<x,n&&(o=q(y,z)),i=1,j=!0,k=!1)),c+=l?-1*o:o,0>c?c+=b:c>=b&&(c-=b);var D,E,F,G,H=m(a[0],c);return j?(i-=.0025,F=H*(1-i),D=1===C?F+s*i:F+s[0]*i,2===C&&(G=m(a[1],c),F=G*(1-i),E=1===C?D:F+s[1]*i),.0025>=i&&(j=!1)):k?(i-=.0025,F=H*i,D=1===C?F+s*i:F+s[0]*(1-i),2===C&&(G=m(a[1],c),F=G*i,E=F+s[1]*(1-i)),.0025>=i&&(k=!1,g=!1,l=!1,o=1,n=0)):1===C?D=g&&p?H*A+s*B:s:(G=m(a[1],c),D=g&&p?H*A+s[0]*B:s[0],E=g&&p?G*A+s[1]*B:s[1]),r=[D,E],1===C?D:r}}).init().processProperties(arguments)},Gibberish.BufferShuffler.prototype=Gibberish._effect,Gibberish.AllPass=function(a){var b=-1,c=new Float32Array(a||500),d=c.length;Gibberish.extend(this,{name:"allpass",properties:{input:0},callback:function(a){b=++b%d;var e=c[b],f=-1*a+e;return c[b]=a+.5*e,f}})},Gibberish.Comb=function(a){var b=new Float32Array(a||1200),c=b.length,d=0,e=0;Gibberish.extend(this,{name:"comb",properties:{input:0,feedback:.84,damping:.2},callback:function(a,f,g){var h=++d%c,i=b[h];return e=i*(1-g)+e*g,b[h]=a+e*f,i}})},Gibberish.Reverb=function(){var a={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.4,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},b=.84,c=[],d=[],e=[0,0];Gibberish.extend(this,{name:"reverb",roomSize:.5,properties:{input:0,wet:.5,dry:.55,roomSize:.84,damping:.5},callback:function(a,b,f,g,h){for(var i="object"==typeof a?2:1,j=1===i?a:a[0]+a[1],k=.015*j,l=k,m=0;8>m;m++){var n=c[m](k,.98*g,.4*h);l+=n}for(var m=0;4>m;m++)l=d[m](l);return e[0]=e[1]=j*f+l*b,e}}).init().processProperties(arguments),this.setFeedback=function(a){b=a};for(var f=0;8>f;f++)c.push(new Gibberish.Comb(a.combTuning[f]).callback);for(var f=0;4>f;f++)d.push(new Gibberish.AllPass(a.allPassTuning[f],a.allPassFeedback).callback)},Gibberish.Reverb.prototype=Gibberish._effect,Gibberish.Granulator=function(a){var b=[];buffer=null,interpolate=Gibberish.interpolate,panner=Gibberish.makePanner(),bufferLength=0,debug=0,write=0,self=this,out=[0,0],_out=[0,0],rndf=Gibberish.rndf,numberOfGrains=a.numberOfGrains||20,Gibberish.extend(this,{name:"granulator",bufferLength:88200,reverse:!0,spread:.5,properties:{speed:1,speedMin:-0,speedMax:0,grainSize:1e3,position:.5,positionMin:0,positionMax:0,amp:.2,fade:.1,pan:0,shouldWrite:!1},setBuffer:function(a){buffer=a,bufferLength=a.length},callback:function(a,c,d,e,f,g,h,i,j,k){for(var l=0;numberOfGrains>l;l++){var m=b[l];if(m._speed>0){m.pos>m.end&&(m.pos=(h+rndf(f,g))*buffer.length,m.start=m.pos,m.end=m.start+e,m._speed=a+rndf(c,d),m._speed=m._speed<.1?.1:m._speed,m._speed=m._speed<.1&&m._speed>0?.1:m._speed,m._speed=m._speed>-.1&&m._speed<0?-.1:m._speed,m.fadeAmount=m._speed*j*e,m.pan=rndf(-1*self.spread,self.spread));for(var n=m.pos;n>buffer.length;)n-=buffer.length;for(;0>n;)n+=buffer.length;var o=interpolate(buffer,n);o*=m.pos<m.fadeAmount+m.start?(m.pos-m.start)/m.fadeAmount:1,o*=m.pos>m.end-m.fadeAmount?(m.end-m.pos)/m.fadeAmount:1}else{m.pos<m.end&&(m.pos=(h+rndf(f,g))*buffer.length,m.start=m.pos,m.end=m.start-e,m._speed=a+rndf(c,d),m._speed=m._speed<.1&&m._speed>0?.1:m._speed,m._speed=m._speed>-.1&&m._speed<0?-.1:m._speed,m.fadeAmount=m._speed*j*e);for(var n=m.pos;n>buffer.length;)n-=buffer.length;for(;0>n;)n+=buffer.length;var o=interpolate(buffer,n);o*=m.pos>m.start-m.fadeAmount?(m.start-m.pos)/m.fadeAmount:1,o*=m.pos<m.end+m.fadeAmount?(m.end-m.pos)/m.fadeAmount:1}_out=panner(o*i,m.pan,_out),out[0]+=_out[0],out[1]+=_out[1],m.pos+=m._speed}return panner(out,k,out)}}).init().processProperties(arguments);for(var c=0;numberOfGrains>c;c++)b[c]={pos:self.position+Gibberish.rndf(self.positionMin,self.positionMax),_speed:self.speed+Gibberish.rndf(self.speedMin,self.speedMax)},b[c].start=b[c].pos,b[c].end=b[c].pos+self.grainSize,b[c].fadeAmount=b[c]._speed*self.fade*self.grainSize,b[c].pan=Gibberish.rndf(-1*self.spread,self.spread);"undefined"!=typeof a.buffer&&(buffer=a.buffer,bufferLength=buffer.length)},Gibberish.Granulator.prototype=Gibberish._effect,Gibberish.synth=function(){this.type="oscillator",this.oscillatorInit=function(){this.fx=new Array2,this.fx.parent=this}},Gibberish.synth.prototype=new Gibberish.ugen,Gibberish._synth=new Gibberish.synth,Gibberish.Synth=function(){this.name="synth",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,glide:.15,amp:.25,channels:2,pan:0,sr:Gibberish.context.sampleRate},this.note=function(b,c){"object"!=typeof this.frequency?(this.frequency=b,_frequency=b):(this.frequency[0]=b,_frequency=b,Gibberish.dirty(this)),"undefined"!=typeof c&&(this.amp=c),a.run()};var a=new Gibberish.AD,b=a.getState,c=a.callback,d=new Gibberish.PWM,e=d.callback,f=(new Gibberish.OnePole).callback,g=Gibberish.makePanner(),h=[0,0];this.callback=function(a,d,i,j,k,l,m,n,o){if(k=k>=1?.99999:k,a=f(a,1-k,k),b()<2){var p=c(i,j),q=e(a,1,d,o)*p*l;return h[0]=h[1]=q,1===m?q:g(q,n,h)}return q=h[0]=h[1]=0,1===m?q:h},this.getOsc=function(){return d},this.setOsc=function(a){d=a,e=d.callback};var i="PWM";Object.defineProperty(this,"waveform",{get:function(){return i},set:function(a){this.setOsc(new Gibberish[a])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth.prototype=Gibberish._synth,Gibberish.PolySynth=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth",maxVoices:5,voiceCount:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,pulsewidth:.5,waveform:"PWM"},note:function(a,b){var c=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),c.note(a,b)}}),this.amp=1/this.maxVoices,Gibberish.polyInit(this),this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices),this.dirty=!0;for(var a=0;a<this.maxVoices;a++){var b={waveform:this.waveform,attack:this.attack,decay:this.decay,pulsewidth:this.pulsewidth,channels:2,amp:1},c=new Gibberish.Synth(b);c.connect(this),this.children.push(c)}this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.Synth2=function(){this.name="synth2",this.properties={frequency:0,pulsewidth:.5,attack:22050,decay:22050,cutoff:.25,resonance:3.5,useLowPassFilter:!0,glide:.15,amp:.25,channels:1,pan:0,sr:Gibberish.context.sampleRate},this.note=function(b,c){"object"!=typeof this.frequency?this.frequency=b:(this.frequency[0]=b,Gibberish.dirty(this)),"undefined"!=typeof c&&(this.amp=c),a.run()};var a=new Gibberish.AD,b=a.getState,c=a.callback,d=new Gibberish.PWM,e=d.callback,f=new Gibberish.Filter24,g=f.callback,h=(new Gibberish.OnePole).callback,i=Gibberish.makePanner(),j=[0,0];this.callback=function(a,d,f,k,l,m,n,o,p,q,r,s){if(b()<2){o=o>=1?.99999:o,a=h(a,1-o,o);var t=c(f,k),u=g(e(a,.15,d,s),l*t,m,n)*t*p;return j[0]=j[1]=u,1===q?u:i(u,r,j)}return u=j[0]=j[1]=0,1===q?u:i(u,r,j)},this.getOsc=function(){return d},this.setOsc=function(a){d=a,e=d.callback};var k="PWM";Object.defineProperty(this,"waveform",{get:function(){return k},set:function(a){this.setOsc(new Gibberish[a])}}),this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.Synth2.prototype=Gibberish._synth,Gibberish.PolySynth2=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polysynth2",maxVoices:5,voiceCount:0,polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,pulsewidth:.5,waveform:"PWM"},note:function(a,b){var c=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),c.note(a,b)}}),this.amp=1/this.maxVoices,Gibberish.polyInit(this),this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices),this.dirty=!0;for(var a=0;a<this.maxVoices;a++){var b={attack:this.attack,decay:this.decay,pulsewidth:this.pulsewidth,channels:2,amp:1},c=new Gibberish.Synth2(b);c.connect(this),this.children.push(c)}this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},Gibberish.FMSynth=function(){this.name="fmSynth",this.properties={frequency:0,cmRatio:2,index:5,attack:22050,decay:22050,glide:.15,amp:.25,channels:2,pan:0},this.note=function(b,c){"object"!=typeof this.frequency?(this.frequency=b,_frequency=b):(this.frequency[0]=b,_frequency=b,Gibberish.dirty(this)),"undefined"!=typeof c&&(this.amp=c),a.run()};var a=new Gibberish.AD,b=a.getState,c=a.callback,d=(new Gibberish.Sine).callback,e=(new Gibberish.Sine).callback,f=(new Gibberish.OnePole).callback,g=Gibberish.makePanner(),h=[0,0];this.callback=function(a,i,j,k,l,m,n,o,p){if(b()<2){m>=1&&(m=.9999),a=f(a,1-m,m);var q=c(k,l),r=e(a*i,a*j)*q,s=d(a+r,1)*q*n;return h[0]=h[1]=s,1===o?s:g(s,p,h)}return s=h[0]=h[1]=0,1===o?s:g(s,p,h)},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.FMSynth.prototype=Gibberish._synth,Gibberish.PolyFM=function(){this.__proto__=new Gibberish.Bus2,Gibberish.extend(this,{name:"polyfm",maxVoices:5,voiceCount:0,children:[],polyProperties:{frequency:0,glide:0,attack:22050,decay:22050,index:5,cmRatio:2},note:function(a,b){var c=this.children[this.voiceCount++];this.voiceCount>=this.maxVoices&&(this.voiceCount=0),c.note(a,b)}}),this.amp=1/this.maxVoices,Gibberish.polyInit(this),this.children=[],"object"==typeof arguments[0]&&(this.maxVoices=arguments[0].maxVoices?arguments[0].maxVoices:this.maxVoices);for(var a=0;a<this.maxVoices;a++){var b={attack:this.attack,decay:this.decay,cmRatio:this.cmRatio,index:this.index,channels:2,amp:1},c=new Gibberish.FMSynth(b);c.connect(this),this.children.push(c)}this.processProperties(arguments),Gibberish._synth.oscillatorInit.call(this)},AudioFileRequest.prototype.onSuccess=function(){},AudioFileRequest.prototype.onFailure=function(){},AudioFileRequest.prototype.send=function(){if("wav"!=this.extension&&"aiff"!=this.extension&&"aif"!=this.extension)return this.onFailure(),void 0;var a=new XMLHttpRequest;a.open("GET",this.url,this.async),a.overrideMimeType("text/plain; charset=x-user-defined"),a.onreadystatechange=function(){4==a.readyState&&(200==a.status||0==a.status?this.handleResponse(a.responseText):this.onFailure())}.bind(this),a.send(null)},AudioFileRequest.prototype.handleResponse=function(a){var b,c;"wav"==this.extension?(b=new WAVDecoder,c=b.decode(a)):("aiff"==this.extension||"aif"==this.extension)&&(b=new AIFFDecoder,c=b.decode(a)),this.onSuccess(c)},Decoder.prototype.readString=function(a,b,c){return a.slice(b,b+c)},Decoder.prototype.readIntL=function(a,b,c){for(var d=0,e=0;c>e;e++)d+=(255&a.charCodeAt(b+e))*Math.pow(2,8*e);return d},Decoder.prototype.readChunkHeaderL=function(a,b){var c={};return c.name=this.readString(a,b,4),c.length=this.readIntL(a,b+4,4),c},Decoder.prototype.readIntB=function(a,b,c){for(var d=0,e=0;c>e;e++)d+=(255&a.charCodeAt(b+e))*Math.pow(2,8*(c-e-1));return d},Decoder.prototype.readChunkHeaderB=function(a,b){var c={};return c.name=this.readString(a,b,4),c.length=this.readIntB(a,b+4,4),c},Decoder.prototype.readFloatB=function(a,b){var c=this.readIntB(a,b,2),d=32768;c>=d&&(c|=~(d-1));var e=1;0>c&&(e=-1,c+=d);var f,g=this.readIntB(a,b+2,4),h=this.readIntB(a,b+6,4);return 0==(c==g==h)?f=0:32767==c?f=Number.MAX_VALUE:(c-=16383,f=(4294967296*g+h)*Math.pow(2,c-63)),e*f},WAVDecoder.prototype.__proto__=Decoder.prototype,WAVDecoder.prototype.decode=function(a){var b={},c=0,d=this.readChunkHeaderL(a,c);if(c+=8,"RIFF"!=d.name)return null;var e=d.length;e+=8;var f=this.readString(a,c,4);if(c+=4,"WAVE"!=f)return null;for(;e>c;){var d=this.readChunkHeaderL(a,c);if(c+=8,"fmt "==d.name){var g=this.readIntL(a,c,2);if(c+=2,1!=g)return null;var h=this.readIntL(a,c,2);c+=2;var i=this.readIntL(a,c,4);c+=4,c+=4,c+=2;var j=this.readIntL(a,c,2),k=j/8;c+=2}else if("data"==d.name){for(var l=d.length/(k*h),m=[],n=0;h>n;n++)m.push(new Float32Array(l));for(var n=0;h>n;n++)for(var o=m[n],p=0;l>p;p++){var q=c;q+=(p*h+n)*k;var r=this.readIntL(a,q,k),s=1<<j-1;r>=s&&(r|=~(s-1)),o[p]=r/s}c+=d.length}else c+=d.length}return b.sampleRate=i,b.bitDepth=j,b.channels=m,b.length=l,b},AIFFDecoder.prototype.__proto__=Decoder.prototype,AIFFDecoder.prototype.decode=function(a){var b={},c=0,d=this.readChunkHeaderB(a,c);if(c+=8,"FORM"!=d.name)return null;var e=d.length;e+=8;var f=this.readString(a,c,4);if(c+=4,"AIFF"!=f)return null;for(;e>c;){var d=this.readChunkHeaderB(a,c);if(c+=8,"COMM"==d.name){var g=this.readIntB(a,c,2);c+=2;var h=this.readIntB(a,c,4);c+=4;for(var i=[],j=0;g>j;j++)i.push(new Float32Array(h));var k=this.readIntB(a,c,2),l=k/8;c+=2;var m=this.readFloatB(a,c);c+=10}else if("SSND"==d.name){var n=this.readIntB(a,c,4);c+=4,c+=4,c+=n;for(var j=0;g>j;j++)for(var o=i[j],p=0;h>p;p++){var q=c;q+=(p*g+j)*l;var r=this.readIntB(a,q,l),s=1<<k-1;r>=s&&(r|=~(s-1)),o[p]=r/s}c+=d.length-n-8}else c+=d.length}return b.sampleRate=m,b.bitDepth=k,b.channels=i,b.length=h,b},Gibberish.Sampler=function(){var a=1,b=Gibberish.interpolate,c=Gibberish.makePanner(),d=[0,0],e=null,f=1,g=this;if(Gibberish.extend(this,{name:"sampler",file:null,isLoaded:!1,playOnLoad:0,properties:{pitch:1,amp:1,isRecording:!1,isPlaying:!0,input:0,length:0,start:0,end:1,loops:0,pan:0},_onload:function(b){e=b.channels[0],f=b.length,g.end=f,g.length=a=f,g.isPlaying=!0,Gibberish.audioFiles[g.file]=e,g.onload&&g.onload(),0!==g.playOnLoad&&g.note(g.playOnLoad),g.isLoaded=!0},floatTo16BitPCM:function(a,b,c){for(var d=0;d<c.length-1;d++,b+=2){var e=Math.max(-1,Math.min(1,c[d]));a.setInt16(b,0>e?32768*e:32767*e,!0)}},encodeWAV:function(){function a(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c.charCodeAt(d))}var b=this.getBuffer(),c=new ArrayBuffer(44+2*b.length),d=new DataView(c),e=Gibberish.context.sampleRate;return a(d,0,"RIFF"),d.setUint32(4,32+2*b.length,!0),a(d,8,"WAVE"),a(d,12,"fmt "),d.setUint32(16,16,!0),d.setUint16(20,1,!0),d.setUint16(22,1,!0),d.setUint32(24,e,!0),d.setUint32(28,4*e,!0),d.setUint16(32,2,!0),d.setUint16(34,16,!0),a(d,36,"data"),d.setUint32(40,2*b.length,!0),this.floatTo16BitPCM(d,44,b),d},download:function(){var a=this.encodeWAV(),b=new Blob([a]),c=window.webkitURL.createObjectURL(b),d=window.document.createElement("a");d.href=c,d.download="output.wav";var e=document.createEvent("Event");e.initEvent("click",!0,!0),d.dispatchEvent(e)},note:function(b,c){if("number"==typeof this.pitch?this.pitch=b:"object"==typeof this.pitch&&(this.pitch[0]=b,Gibberish.dirty(this)),"number"==typeof c&&(this.amp=c),null!==this.function){this.isPlaying=!0;var d="number"==typeof this.pitch?this.pitch:this.pitch[0];a=d>0?this.start:this.end}},getBuffer:function(){return e},setBuffer:function(a){e=a},getPhase:function(){return a},setPhase:function(b){a=b},callback:function(f,g,h,i,j,k,l,m,n,o){var p=0;return a+=f,m>a&&a>0?(f>0?p=null!==e&&i?b(e,a):0:a>l?p=null!==e&&i?b(e,a):0:a=n?m:a,c(p*g,o,d)):(a=n&&f>0?l:a,a=n&&0>f?m:a,d[0]=d[1]=p,d)}}).init().oscillatorInit().processProperties(arguments),"undefined"!=typeof arguments[0]&&("string"==typeof arguments[0]?(this.file=arguments[0],this.pitch=0):"object"==typeof arguments[0]&&arguments[0].file&&(this.file=arguments[0].file)),"undefined"!=typeof Gibberish.audioFiles[this.file])e=Gibberish.audioFiles[this.file],this.end=this.bufferLength=e.length,a=this.bufferLength,Gibberish.dirty(this),this.onload&&this.onload();else if(null!==this.file){var h=new AudioFileRequest(this.file);h.onSuccess=this._onload,h.send()}else"undefined"!=typeof this.buffer&&(this.isLoaded=!0,e=this.buffer,this.end=this.bufferLength=e.length||88200,a=this.bufferLength,arguments[0]&&arguments[0].loops&&(this.loops=1),Gibberish.dirty(this),this.onload&&this.onload())},Gibberish.Sampler.prototype=Gibberish._oscillator,Gibberish.Sampler.prototype.record=function(a,b){this.isRecording=!0;var c=this;return this.recorder=new Gibberish.Record(a,b,function(){c.setBuffer(this.getBuffer()),c.end=bufferLength=c.getBuffer().length,c.setPhase(c.end),c.isRecording=!1}).record(),this},Gibberish.MonoSynth=function(){Gibberish.extend(this,{name:"monosynth",properties:{frequency:0,amp1:1,amp2:1,amp3:1,attack:1e4,decay:1e4,cutoff:.2,resonance:2.5,filterMult:.3,isLowPass:!0,pulsewidth:.5,amp:.6,detune2:.01,detune3:-.01,octave2:1,octave3:-1,glide:0,pan:0,channels:1},waveform:"Saw3",note:function(a,d){"undefined"!=typeof d&&(this.amp=d),"object"!=typeof this.frequency?this.frequency=a:(this.frequency[0]=a,Gibberish.dirty(this)),c()>0&&b.run()}});var a=this.waveform;Object.defineProperty(this,"waveform",{get:function(){return a},set:function(b){a!==b&&(a=b,f=(new Gibberish[b]).callback,g=(new Gibberish[b]).callback,h=(new Gibberish[b]).callback)}});var b=new Gibberish.AD(this.attack,this.decay),c=b.getState,d=b.callback,e=(new Gibberish.Filter24).callback,f=new Gibberish[this.waveform](this.frequency,this.amp1).callback,g=new Gibberish[this.waveform](this.frequency2,this.amp2).callback,h=new Gibberish[this.waveform](this.frequency3,this.amp3).callback,i=(new Gibberish.OnePole).callback,j=Gibberish.makePanner(),k=[0,0];this.callback=function(a,b,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){if(c()<2){z>=1&&(z=.9999),a=i(a,1-z,z);var C=a;if(x>0)for(var D=0;x>D;D++)C*=2;else if(0>x)for(var D=0;D>x;D--)C/=2;var E=a;if(y>0)for(var D=0;y>D;D++)E*=2;else if(0>y)for(var D=0;D>y;D--)E/=2;C+=v>0?(2*a-a)*v:(a-a/2)*v,E+=w>0?(2*a-a)*w:(a-a/2)*w;var F=f(a,b,t)+g(C,l,t)+h(E,m,t),G=d(n,o),H=e(F,p+r*G,q,s,1)*G;return H*=u,k[0]=k[1]=H,1===B?k:j(H,A,k)}return k[0]=k[1]=0,k},this.init(),this.oscillatorInit(),this.processProperties(arguments)},Gibberish.MonoSynth.prototype=Gibberish._synth,Gibberish.Binops={"export":function(a){Gibberish.export("Binops",a||window)},operator:function(){var a=new Gibberish.ugen,b=arguments[0],c=Array.prototype.slice.call(arguments,1);a.name="op",a.properties={};for(var d=0;d<c.length;d++)a.properties[d]=c[d];return a.init.apply(a,c),a.codegen=function(){var a,c="( ";a=Object.keys(this.properties);for(var d=0;d<a.length;d++){var e="object"==typeof this[d];c+=e?this[d].codegen():this[d],d<a.length-1&&(c+=" "+b+" ")}return c+=" )",this.codeblock=c,c},a},Add:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("+"),Gibberish.Binops.operator.apply(null,a)},Sub:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("-"),Gibberish.Binops.operator.apply(null,a)},Mul:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("*"),Gibberish.Binops.operator.apply(null,a)},Div:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("/"),Gibberish.Binops.operator.apply(null,a)},Mod:function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift("%"),Gibberish.Binops.operator.apply(null,a)},Abs:function(){var a=(Array.prototype.slice.call(arguments,0),{name:"abs",properties:{},callback:Math.abs});return a.__proto__=new Gibberish.ugen,a.properties[0]=arguments[0],a.init(),a},Sqrt:function(){var a=(Array.prototype.slice.call(arguments,0),{name:"sqrt",properties:{},callback:Math.sqrt});return a.__proto__=new Gibberish.ugen,a.properties[i]=arguments[0],a.init(),a},Pow:function(){var a=Array.prototype.slice.call(arguments,0),b={name:"pow",properties:{},callback:Math.pow};b.__proto__=new Gibberish.ugen;for(var c=0;c<a.length;c++)b.properties[c]=a[c];return b.init(),b},Merge:function(){var a=Array.prototype.slice.call(arguments,0),b={name:"merge",properties:{},callback:function(a){return a[0]+a[1]}};b.__proto__=new Gibberish.ugen;for(var c=0;c<a.length;c++)b.properties[c]=a[c];return b.init(),b},Map:function(a,b,c,d,e,f,g){var h=Math.pow,i=0,j=0,k={name:"map",properties:{input:a,outputMin:b,outputMax:c,inputMin:d,inputMax:e,curve:f||i,wrap:g||!1},callback:function(a,b,c,d,e,f,g){var i,k=c-b,l=e-d,m=(a-d)/l;return m>1?m=g?m%1:1:0>m&&(m=g?1+m%1:0),i=0===f?b+m*k:b+h(m,1.5)*k,j=i,i},getValue:function(){return j}};return k.__proto__=new Gibberish.ugen,k.init(),k}},Gibberish.Time={bpm:120,"export":function(a){Gibberish.export("Time",a||window)},ms:function(a){return a*Gibberish.context.sampleRate/1e3},seconds:function(a){return a*Gibberish.context.sampleRate},beats:function(a){return function(){var b=Gibberish.context.sampleRate/(Gibberish.Time.bpm/60);return b*a}}},Gibberish.Sequencer2=function(){var a=this,b=0;Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},properties:{rate:1,isRunning:!1,nextTime:0},offset:0,name:"seq",callback:function(c,d,e){if(d){if(b>=e){if(null!==a.values){if(a.target){var f=a.values[a.valuesIndex++];"function"==typeof f&&(f=f()),"function"==typeof a.target[a.key]?a.target[a.key](f):a.target[a.key]=f}else"function"==typeof a.values[a.valuesIndex]&&a.values[a.valuesIndex++]();a.valuesIndex>=a.values.length&&(a.valuesIndex=0)}else if(null!==a.keysAndValues)for(var g in a.keysAndValues){var h=a.counts[g]++,f=a.keysAndValues[g][h];"function"==typeof f&&(f=f()),"function"==typeof a.target[g]?a.target[g](f):a.target[g]=f,a.counts[g]>=a.keysAndValues[g].length&&(a.counts[g]=0)}else"function"==typeof a.target[a.key]&&a.target[a.key]();if(b-=e,Array.isArray(a.durations)){var i=a.durations[a.durationsIndex++];a.nextTime="function"==typeof i?i():i,a.durationsIndex>=a.durations.length&&(a.durationsIndex=0)}else{var i=a.durations;a.nextTime="function"==typeof i?i():i}return a.repeatTarget&&(a.repeatCount++,a.repeatCount===a.repeatTarget&&(a.isRunning=!1,a.repeatCount=0)),0}b+=c}return 0},start:function(a){return a||(b=0),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(a){return this.repeatTarget=a,this}}),this.init(arguments),this.processProperties(arguments);for(var c in this.keysAndValues)this.counts[c]=0;this.oscillatorInit(),b+=this.offset,this.connect()},Gibberish.Sequencer2.prototype=Gibberish._oscillator,Gibberish.Sequencer=function(){Gibberish.extend(this,{target:null,key:null,values:null,valuesIndex:0,durations:null,durationsIndex:0,nextTime:0,phase:0,isRunning:!1,playOnce:!1,repeatCount:0,repeatTarget:null,isConnected:!0,keysAndValues:null,counts:{},offset:0,name:"seq",tick:function(){if(this.isRunning){if(this.phase>=this.nextTime){if(null!==this.values){if(this.target){var a=this.values[this.valuesIndex++];"function"==typeof a&&(a=a()),"function"==typeof this.target[this.key]?this.target[this.key](a):this.target[this.key]=a}else"function"==typeof this.values[this.valuesIndex]&&this.values[this.valuesIndex++]();this.valuesIndex>=this.values.length&&(this.valuesIndex=0)}else if(null!==this.keysAndValues)for(var b in this.keysAndValues){var c="function"==typeof this.keysAndValues[b].pick?this.keysAndValues[b].pick():this.counts[b]++,a=this.keysAndValues[b][c];"function"==typeof a&&(a=a()),"function"==typeof this.target[b]?this.target[b](a):this.target[b]=a,this.counts[b]>=this.keysAndValues[b].length&&(this.counts[b]=0)}else"function"==typeof this.target[this.key]&&this.target[this.key]();if(this.phase-=this.nextTime,Array.isArray(this.durations)){var d="function"==typeof this.durations.pick?this.durations[this.durations.pick()]:this.durations[this.durationsIndex++];this.nextTime="function"==typeof d?d():d,this.durationsIndex>=this.durations.length&&(this.durationsIndex=0)}else{var d=this.durations;this.nextTime="function"==typeof d?d():d}return this.repeatTarget&&(this.repeatCount++,this.repeatCount===this.repeatTarget&&(this.isRunning=!1,this.repeatCount=0)),void 0}this.phase++}},start:function(a){return a||(this.phase=this.offset),this.isRunning=!0,this},stop:function(){return this.isRunning=!1,this},repeat:function(a){return this.repeatTarget=a,this},disconnect:function(){var a=Gibberish.sequencers.indexOf(this);Gibberish.sequencers.splice(a,1),this.isConnected=!1},connect:function(){return-1===Gibberish.sequencers.indexOf(this)&&Gibberish.sequencers.push(this),this.isConnected=!0,this}});for(var a in arguments[0])this[a]=arguments[0][a];for(var a in this.keysAndValues)this.counts[a]=0;this.connect(),this.phase+=this.offset},Gibberish.Sequencer.prototype=Gibberish._oscillator;var _hasInput=!1;Gibberish.Input=function(){var a=[];_hasInput||createInput(),this.type=this.name="input",this.fx=new Array2,this.fx.parent=this,this.properties={input:"input",amp:.5,channels:1},this.callback=function(b,c,d){return 1===d?a=b*c:(a[0]=b[0]*c,a[1]=b[1]*c),a},this.init(arguments),this.processProperties(arguments)},Gibberish.Input.prototype=new Gibberish.ugen,Gibberish.Kick=function(){var a=!1,b=(new Gibberish.SVF).callback,c=(new Gibberish.SVF).callback,d=.2,e=.8;Gibberish.extend(this,{name:"kick",properties:{pitch:50,__decay:20,__tone:1e3,amp:2,sr:Gibberish.context.sampleRate},callback:function(d,e,f,g,h){var i=a?60:0;return i=b(i,d,e,2,h),i=c(i,f,.5,0,h),i*=g,a=!1,i},note:function(b,c,d,e){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.decay=c),"number"==typeof d&&(this.tone=d),"number"==typeof e&&(this.amp=e),a=!0}}).init().oscillatorInit(),Object.defineProperties(this,{decay:{get:function(){return d},set:function(a){d=a>1?1:a,this.__decay=100*d}},tone:{get:function(){return e},set:function(a){e=a>1?1:a,this.__tone=220+1400*a}}}),this.processProperties(arguments)},Gibberish.Kick.prototype=Gibberish._oscillator,Gibberish.Conga=function(){var a=!1,b=(new Gibberish.SVF).callback;Gibberish.extend(this,{name:"conga",properties:{pitch:190,amp:2,sr:Gibberish.context.sampleRate},callback:function(c,d,e){var f=a?60:0;return f=b(f,c,50,2,e),f*=d,a=!1,f},note:function(b,c){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.amp=c),a=!0}}).init().oscillatorInit(),this.processProperties(arguments)},Gibberish.Conga.prototype=Gibberish._oscillator,Gibberish.Clave=function(){var a=!1,b=new Gibberish.SVF,c=b.callback;Gibberish.extend(this,{name:"clave",properties:{pitch:2500,amp:1,sr:Gibberish.context.sampleRate},callback:function(b,d,e){var f=a?2:0;return f=c(f,b,5,2,e),f*=d,a=!1,f},note:function(b,c){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.amp=c),a=!0}}).init().oscillatorInit(),this.bpf=b,this.processProperties(arguments)},Gibberish.Clave.prototype=Gibberish._oscillator,Gibberish.Tom=function(){var a=!1,b=(new Gibberish.SVF).callback,c=(new Gibberish.SVF).callback,d=new Gibberish.ExponentialDecay,e=d.callback,f=Math.random;Gibberish.extend(this,{name:"tom",properties:{pitch:80,amp:.5,sr:Gibberish.context.sampleRate},callback:function(d,g,h){var i,j=a?60:0;return j=b(j,d,30,2,h),i=16*f()-8,i=i>0?i:0,i*=e(.05,11025),i=c(i,120,.5,0,h),j+=i,j*=g,a=!1,j},note:function(b,c){"number"==typeof b&&(this.pitch=b),"number"==typeof c&&(this.amp=c),d.trigger(),a=!0}}).init().oscillatorInit(),d.trigger(1),this.processProperties(arguments)},Gibberish.Tom.prototype=Gibberish._oscillator,Gibberish.Cowbell=function(){var a=new Gibberish.Square,b=new Gibberish.Square,c=a.callback,d=b.callback,e=new Gibberish.SVF({mode:2}),f=e.callback,g=new Gibberish.ExponentialDecay(.0025,10500),h=g.callback;Gibberish.extend(this,{name:"cowbell",properties:{amp:1,pitch:560,bpfFreq:1e3,bpfRez:3,decay:22050,decayCoeff:1e-4,sr:Gibberish.context.sampleRate},callback:function(a,b,e,g,i,j,k){var l;return l=c(b,1,1,0),l+=d(845,1,1,0),l=f(l,e,g,2,k),l*=h(j,i),l*=a},note:function(a){g.trigger(),a&&(this.decay=a)}}).init().oscillatorInit().processProperties(arguments),this.bpf=e,this.eg=g,g.trigger(1)},Gibberish.Cowbell.prototype=Gibberish._oscillator,Gibberish.Snare=function(){var a=(new Gibberish.SVF).callback,b=(new Gibberish.SVF).callback,c=(new Gibberish.SVF).callback,d=new Gibberish.ExponentialDecay(.0025,11025),e=d.callback,f=Math.random,g=0;Gibberish.extend(this,{name:"snare",properties:{cutoff:1e3,decay:11025,tune:0,snappy:.5,amp:1,sr:Gibberish.context.sampleRate},callback:function(d,h,i,j,k,l){var m,n,o=0,p=0;return o=e(.0025,h),o>.005&&(p=(2*f()-1)*o,p=c(p,d+1e3*i,.5,1,l),p*=j,p=p>0?p:0,g=o,m=a(g,180*(i+1),15,2,l),n=b(g,330*(i+1),15,2,l),p+=m,p+=.8*n,p*=k),p},note:function(a,b,c,e){"number"==typeof a&&(this.tune=a),"number"==typeof e&&(this.cutoff=e),"number"==typeof c&&(this.snappy=c),"number"==typeof b&&(this.amp=b),d.trigger()}}).init().oscillatorInit().processProperties(arguments),d.trigger(1)},Gibberish.Snare.prototype=Gibberish._oscillator,Gibberish.Hat=function(){var a=new Gibberish.Square,b=new Gibberish.Square,c=new Gibberish.Square,d=new Gibberish.Square,e=new Gibberish.Square,f=new Gibberish.Square,g=a.callback,h=b.callback,i=c.callback,j=d.callback,k=e.callback,l=f.callback,m=new Gibberish.SVF({mode:2}),n=m.callback,o=new Gibberish.Filter24,p=o.callback,q=new Gibberish.ExponentialDecay(.0025,10500),r=q.callback,s=new Gibberish.ExponentialDecay(.1,7500);s.callback,Gibberish.extend(this,{name:"hat",properties:{amp:1,pitch:325,bpfFreq:7e3,bpfRez:2,hpfFreq:.975,hpfRez:0,decay:3500,decay2:3e3,sr:Gibberish.context.sampleRate},callback:function(a,b,c,d,e,f,m,o,q){var s;return s=g(b,1,.5,0),s+=h(1.4471*b,.75,1,0),s+=i(1.617*b,1,1,0),s+=j(1.9265*b,1,1,0),s+=k(2.5028*b,1,1,0),s+=l(2.6637*b,.75,1,0),s=n(s,c,d,2,q),s*=r(.001,m),s=p(s,e,f,0,1),s*=a},note:function(a,b){q.trigger(),s.trigger(),a&&(this.decay=a),b&&(this.decay2=b)}}).init().oscillatorInit().processProperties(arguments),this.bpf=m,this.hpf=o,q.trigger(1),s.trigger(1)},Gibberish.Hat.prototype=Gibberish._oscillator;
